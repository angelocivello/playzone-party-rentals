<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Playzone Party Rentals â€” Central PA Yard Games</title>
<meta name="description" content="Playzone Party Rentals â€” Backyard & yard game rentals across Central PA. Based in Palmyra (17078). Phone: 717-376-7617" />
<style>
  :root{
    --blue:#0b63d8;
    --lime:#9be21d;
    --white:#ffffff;
    --dark:#071033;
    --muted:#6b7280;
    --card:#f7fbff;
    --radius:14px;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{margin:0;background:linear-gradient(180deg,#f3f7ff,#ffffff);color:var(--dark);-webkit-font-smoothing:antialiased}
  a{color:inherit}
  .container{max-width:1160px;margin:0 auto;padding:20px}

  /* Header */
  header.site-header{
    background:linear-gradient(90deg,var(--blue), #2a9df4);
    color:var(--white);
    padding:18px 20px;
    border-bottom:6px solid rgba(11,99,216,0.12);
  }
  .top{display:flex;align-items:center;gap:16px;justify-content:space-between;flex-wrap:wrap;max-width:1160px;margin:0 auto}
  .brand{display:flex;align-items:center;gap:14px}
  .logo-wrap{width:84px;height:64px;border-radius:10px;background:linear-gradient(135deg,var(--blue),#1785ff);display:flex;align-items:center;justify-content:center;color:white;font-weight:900;box-shadow:0 10px 30px rgba(11,99,216,0.12)}
  .brand h1{margin:0;font-size:1.35rem;letter-spacing:0.2px}
  .tag{font-weight:600;color:rgba(255,255,255,0.95);font-size:0.95rem}

  nav{display:flex;gap:10px;align-items:center}
  a.cta{background:var(--lime);color:var(--dark);font-weight:800;padding:9px 14px;border-radius:12px;text-decoration:none}

  /* Hero */
  .hero{display:grid;grid-template-columns:1fr;gap:18px;align-items:center;padding:26px 0}
  .hero-left h2{margin:0;font-size:1.9rem;color:#02143a}
  .lead{color:var(--muted);margin-top:8px}
  .badges{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
  .pill{background:var(--card);padding:8px 10px;border-radius:999px;font-weight:700;color:var(--blue)}
  .logo-mini{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--blue),#1785ff);display:flex;align-items:center;justify-content:center;color:white;font-weight:900}

  /* Image grid */
  .games-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:12px}
  .game-card{background:white;border-radius:12px;overflow:hidden;border:1px solid rgba(11,21,48,0.04);box-shadow:0 8px 30px rgba(11,21,48,0.04);cursor:pointer;display:flex;flex-direction:column;transition:transform .12s ease,box-shadow .12s ease}
  .game-card:hover{transform:translateY(-6px);box-shadow:0 18px 40px rgba(11,21,48,0.08)}
  .game-card img{width:100%;height:160px;object-fit:cover;display:block;background:#f2f6ff}
  .game-card .meta{padding:12px;display:flex;align-items:center;justify-content:space-between;gap:8px}
  .game-card .meta .title{font-weight:800}
  .badge{width:36px;height:36px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-weight:800;color:#fff}
  .badge.basic{background:var(--blue)}
  .badge.premium{background:var(--lime);color:#02143a}

  /* Packages */
  .grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:12px}
  .card{background:white;border-radius:14px;padding:16px;border:1px solid rgba(11,21,48,0.04);box-shadow:0 8px 24px rgba(11,21,48,0.04)}
  .card.highlight{border:2px solid rgba(155,226,29,0.12)}
  .package-title{font-size:1.15rem;font-weight:800;color:var(--blue)}
  .price{font-weight:900;color:var(--dark);font-size:1.25rem;margin-top:6px}
  .note{font-size:0.95rem;color:var(--muted);margin-top:6px}

  /* Booking form */
  .booking-row{display:flex;gap:12px;flex-wrap:wrap}
  .field{flex:1;min-width:180px;display:flex;flex-direction:column;margin-bottom:8px}
  label{font-weight:700;margin-bottom:6px}
  input[type=text],input[type=email],input[type=tel],select,textarea{padding:10px;border-radius:10px;border:1px solid rgba(11,21,48,0.08);font-size:1rem}
  textarea{min-height:90px;resize:vertical}
  .addons{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:6px}
  .addon{display:flex;align-items:center;gap:8px;padding:8px;border-radius:10px;border:1px solid rgba(11,21,48,0.04);background:#fff}

  .summary{background:linear-gradient(180deg,#fff,#f7fff0);padding:12px;border-radius:10px;border:1px solid rgba(11,21,48,0.03)}
  .total{font-weight:900;font-size:1.2rem;color:var(--blue)}

  .btn{background:var(--blue);color:white;padding:10px 14px;border-radius:10px;border:0;font-weight:800;cursor:pointer}
  .btn.secondary{background:transparent;border:2px solid rgba(11,21,48,0.06);color:var(--dark)}

  footer{padding:18px;text-align:center;color:var(--muted);margin-top:20px}

  /* Calendar */
  .calendar{border-radius:12px;border:1px solid rgba(11,21,48,0.04);padding:10px;background:#fff}
  .calendar header{display:flex;justify-content:space-between;align-items:center;padding:6px 8px}
  .calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;padding:6px}
  .day{padding:8px;border-radius:8px;text-align:center}
  .day.today{border:1px dashed rgba(11,99,216,0.18)}
  .day.selected{background:var(--blue);color:#fff;font-weight:800}
  .day.booked{background:#fef6f0;color:#c23a00;font-weight:800}

  /* responsive */
  @media(max-width:1000px){.games-grid{grid-template-columns:repeat(2,1fr)}}
  @media(max-width:640px){.games-grid{grid-template-columns:1fr}.top{padding-bottom:8px}.hero-left h2{font-size:1.5rem}}
  .link-blue{color:var(--blue);font-weight:700;text-decoration:none}
  .muted{color:var(--muted)}
</style>
</head>
<body>
<header class="site-header">
  <div class="top container">
    <div class="brand">
      <div class="logo-wrap" aria-hidden="true">
        <!-- Logo Style 2 - Modern party brand (clean + blue) -->
        <svg width="140" height="56" viewBox="0 0 420 168" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Playzone Party Rentals logo">
          <defs><linearGradient id="lg" x1="0" x2="1"><stop offset="0" stop-color="#0b63d8"/><stop offset="1" stop-color="#1785ff"/></linearGradient></defs>
          <rect rx="20" width="420" height="168" fill="url(#lg)"/>
          <g transform="translate(18,12)">
            <path d="M0 120 Q140 10 360 70" stroke="#9be21d" stroke-width="18" fill="none" stroke-linecap="round"/>
            <text x="36" y="112" font-size="88" font-weight="900" fill="#fff" font-family="Inter,Arial">PZ</text>
            <text x="170" y="70" font-size="36" font-weight="800" fill="#02143a">Playzone</text>
            <text x="170" y="100" font-size="18" fill="#02143a">Party Rentals</text>
          </g>
        </svg>
      </div>
      <div>
        <h1>Playzone Party Rentals</h1>
        <div class="tag">Yard games & party add-ons â€¢ Based in Palmyra (17078) â€¢ Serving Central PA</div>
      </div>
    </div>

    <nav>
      <a href="#packages" class="small" style="color:white;text-decoration:none;margin-right:10px">Packages</a>
      <a href="#games" class="small" style="color:white;text-decoration:none;margin-right:10px">Games</a>
      <a href="#contact" class="cta">Book Now</a>
    </nav>
  </div>
</header>

<main class="container">
  <section class="hero" aria-labelledby="hero-title">
    <div class="hero-left">
      <h2 id="hero-title">Turn any yard into a Playzone ðŸŽ‰</h2>
      <p class="lead">Fun, safe, and sporty yard games delivered across Central PA. Choose a package, pick your games, and add the extras you want.</p>
      <div class="badges">
        <div class="pill">Serving Central PA</div>
        <div class="pill">Base: Palmyra (17078)</div>
        <div class="pill">24-hour rentals</div>
      </div>

      <div style="margin-top:14px" class="small">
        Contact:
        <a href="tel:7173767617" class="link-blue">717-376-7617</a>
        â€¢
        <a href="mailto:playzonepartyrentals@outlook.com" class="link-blue">playzonepartyrentals@outlook.com</a>
      </div>
    </div>

    <div>
      <div class="card center">
        <div style="display:flex;gap:12px;align-items:center;justify-content:center">
          <div class="logo-mini">PZ</div>
          <div style="text-align:left">
            <div style="font-weight:900">Quick Book</div>
            <div class="small muted">Start a pre-filled email to request a booking</div>
          </div>
        </div>
        <div style="margin-top:12px">
          <button class="btn" onclick="composeEmailFromForm()">Start Booking</button>
        </div>
      </div>
    </div>
  </section>

  <!-- IMAGE GRID: large image tiles for each game -->
  <section id="games" class="card" aria-labelledby="games-title">
    <h2 id="games-title">Games (tap/click a tile to select)</h2>
    <p class="small muted">Tap a game tile to add it to your booking. Premium items show a green badge.</p>

    <div class="games-grid" id="gamesGrid">
      <!-- Game tiles inserted via JS. Placeholder images used; replace with real photos in docs/assets/games/ -->
    </div>
  </section>

  <!-- Packages -->
  <section id="packages" style="margin-top:14px">
    <h2>Packages</h2>
    <div class="grid">
      <div class="card" aria-hidden="false">
        <div class="package-title">Starter Fun</div>
        <div class="price">$60</div>
        <div class="note">Pick up to <strong>3 basic</strong> games. 24-hour rental.</div>
        <div style="margin-top:8px" class="small muted">Great for small family gatherings.</div>
      </div>

      <div class="card highlight">
        <div class="package-title">Party Mix</div>
        <div class="price">$95</div>
        <div class="note">Pick <strong>5 games total</strong>: up to <strong>3 Basic</strong> + <strong>2 Premium</strong>. 24-hour rental.</div>
        <div style="margin-top:8px" class="small muted">Most popular â€” balanced mix of low-effort & premium setups.</div>
      </div>

      <div class="card">
        <div class="package-title">Ultimate Block Party</div>
        <div class="price">$150</div>
        <div class="note">Pick up to <strong>10 games</strong> â€” any mix of basic & premium. 24-hour rental.</div>
        <div style="margin-top:8px" class="small muted">Best for large gatherings and events.</div>
      </div>
    </div>

    <div style="margin-top:10px" class="small muted">Delivery & Pickup: <strong>$30</strong> within 15 miles of <strong>17078</strong>. Additional mileage fee may apply beyond that.</div>
  </section>

  <!-- Booking area: form + calendar -->
  <section id="contact" class="card" style="margin-top:16px">
    <h2>Book / Request a Quote</h2>

    <div style="display:grid;grid-template-columns:1fr 360px;gap:14px">
      <!-- Left: Form -->
      <form id="bookingForm" onsubmit="return handleSubmit(event)" style="background:transparent">
        <div class="booking-row">
          <div class="field"><label for="name">Contact name *</label><input id="name" name="name" required type="text" placeholder="Jane Doe" /></div>
          <div class="field"><label for="phone">Phone *</label><input id="phone" name="phone" required type="tel" placeholder="717-376-7617" /></div>
        </div>

        <div class="booking-row">
          <div class="field"><label for="email">Email *</label><input id="email" name="email" required type="email" placeholder="you@example.com" /></div>
          <div class="field"><label for="date">Event date *</label><input id="date" name="date" required type="date" /></div>
        </div>

        <div style="margin-top:6px">
          <label for="package">Package *</label>
          <select id="package" name="package" required onchange="onPackageChange()">
            <option value="">Choose a package</option>
            <option value="starter">Starter Fun â€” $60 (3 basic)</option>
            <option value="mix">Party Mix â€” $95 (3 basic + 2 premium)</option>
            <option value="ultimate">Ultimate â€” $150 (up to 10 any)</option>
          </select>
        </div>

        <div style="margin-top:8px">
          <label>Selected games</label>
          <div id="selectedList" style="min-height:60px;padding:8px;border-radius:8px;border:1px dashed rgba(11,21,48,0.06);background:#fff"></div>
          <div id="selectionNote" class="small muted" style="margin-top:6px">Choose a package to enable limits.</div>
        </div>

        <div style="margin-top:10px">
          <label>Add-ons</label>
          <div class="addons" id="addonsList"></div>
        </div>

        <div style="margin-top:12px;display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap">
          <div style="flex:1" class="summary">
            <div class="small muted">Order summary</div>
            <div style="margin-top:8px">Package: <span id="summaryPackage">â€”</span></div>
            <div>Games selected: <span id="summaryGames">0</span></div>
            <div>Add-ons: <span id="summaryAddons">0</span></div>
            <div style="margin-top:8px">Delivery: <span id="summaryDelivery">â€”</span></div>
            <div style="margin-top:8px" class="total">Estimated total: $<span id="summaryTotal">0</span></div>
            <div id="formMsg" class="small muted" style="margin-top:8px"></div>
          </div>

          <div style="min-width:220px;display:flex;flex-direction:column;gap:8px">
            <button type="submit" class="btn">Request Booking</button>
            <button type="button" class="btn secondary" onclick="composeEmailFromForm()">Start Booking (Email)</button>
            <button type="button" class="btn secondary" onclick="resetForm()">Reset</button>
          </div>
        </div>

        <!-- Hidden storage -->
        <input type="hidden" name="games" id="hiddenGames" />
        <input type="hidden" name="addons" id="hiddenAddons" />
        <input type="hidden" name="calcTotal" id="hiddenTotal" />
        <input type="hidden" name="source" value="Website - Playzone Party Rentals" />
      </form>

      <!-- Right: Calendar + help -->
      <div>
        <div class="calendar" aria-hidden="false">
          <header><strong>Booking calendar</strong><div class="small muted">Select your event date below</div></header>
          <div style="margin-top:8px" id="calendarContainer"></div>
          <div class="small muted" style="margin-top:8px">Note: This calendar is client-side only. To prevent double-bookings, integrate with Google Calendar or Calendly (instructions below).</div>
        </div>

        <div class="card" style="margin-top:12px">
          <strong>Quick instructions</strong>
          <ul class="small muted">
            <li>Add images to <code>docs/assets/games/</code> â€” filenames listed in the code comments.</li>
            <li>Replace the <code>FORM_ACTION</code> variable in the script with your Formspree endpoint to receive booking emails.</li>
            <li>To avoid double-bookings: set up Calendly or a Google Calendar event feed and add a Calendly link to the Start Booking button (I can help).</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="card" style="margin-top:16px">
    <h2>FAQ</h2>
    <div>
      <strong>How long are rentals?</strong>
      <p class="small muted">24 hours by default â€” pick up the following day or choose delivery & pickup service.</p>

      <strong>Do you supervise?</strong>
      <p class="small muted">No referees or supervision are provided. Adults must supervise children at all times.</p>

      <strong>What about weather?</strong>
      <p class="small muted">We can reschedule due to severe weather; contact us to arrange alternatives.</p>
    </div>
  </section>
</main>

<footer>
  Â© <span id="yr"></span> Playzone Party Rentals â€” Serving Central PA â€¢ Based in Palmyra (17078) â€¢ <a href="tel:7173767617" class="link-blue">717-376-7617</a> â€¢ <a href="mailto:playzonepartyrentals@outlook.com" class="link-blue">playzonepartyrentals@outlook.com</a>
</footer>

<!-- ====== Data & JS ====== -->
<script>
  document.getElementById('yr').textContent = new Date().getFullYear();

  // Replace with your Formspree or backend endpoint to enable live submissions:
  const FORM_ACTION = "https://formspree.io/f/YOUR_FORM_ID"; // <-- REPLACE THIS with your form endpoint

  // ===== Game definitions (images reference assets/games/*.jpg) =====
  // Add matching image files into docs/assets/games/ or adjust data-img paths below.
  const GAMES = [
    { id:'cornhole', name:'Cornhole', type:'basic', img:'assets/games/cornhole.jpg', badge:'C' },
    { id:'kanjam', name:'Kan Jam', type:'basic', img:'assets/games/kanjam.jpg', badge:'KJ' },
    { id:'ringtoss', name:'Ring Toss', type:'basic', img:'assets/games/ringtoss.jpg', badge:'RT' },
    { id:'horseshoes', name:'Horseshoes', type:'basic', img:'assets/games/horseshoes.jpg', badge:'H' },
    { id:'laddertoss', name:'Ladder Toss', type:'basic', img:'assets/games/laddertoss.jpg', badge:'LT' },
    { id:'giantjenga', name:'Giant Jenga', type:'basic', img:'assets/games/giantjenga.jpg', badge:'GJ' },
    { id:'beerpong', name:'Beer Pong', type:'basic', img:'assets/games/beerpong.jpg', badge:'BP' },
    { id:'spikeball', name:'Spikeball', type:'basic', img:'assets/games/spikeball.jpg', badge:'S' },
    { id:'soccer', name:'Soccer', type:'basic', img:'assets/games/soccer.jpg', badge:'SO' },

    // Premium games
    { id:'badminton', name:'Badminton (BM)', type:'premium', img:'assets/games/badminton.jpg', badge:'BM' },
    { id:'axe', name:'Kid-Friendly Axe Throwing (AT)', type:'premium', img:'assets/games/axe.jpg', badge:'AT' },
    { id:'volleyball', name:'Volleyball (VB)', type:'premium', img:'assets/games/volleyball.jpg', badge:'VB' },
    { id:'nerf', name:'Nerf Guns Kit (NG) â€” 10 guns + 300 darts + eye protection', type:'premium', img:'assets/games/nerf.jpg', badge:'NG' }
  ];

  const ADDONS = [
    {id:'speaker', name:'Bluetooth Speaker + 2 mics', price:20},
    {id:'bubble', name:'Bubble Machine (w/ solution)', price:20},
    {id:'slip', name:'Slip & Slide', price:30},
    {id:'waterballoons', name:'Water Balloon Kit', price:10},
    {id:'projector', name:'Projector + Outdoor Screen', price:50},
    {id:'footballs', name:'Footballs (set)', price:5},
    {id:'frisbees', name:'Frisbees (set)', price:5},
    {id:'waterguns', name:'Water Guns Kit', price:20},
    {id:'extranerf', name:'Extra Nerf Gun (each)', price:5},
    {id:'darts', name:'100 Foam Darts (keep or return)', price:10}
  ];

  // Pricing map (packages)
  const PACKAGES = {
    starter:{price:60,label:'Starter Fun', basicLimit:3,premiumLimit:0,totalLimit:3},
    mix:{price:95,label:'Party Mix', basicLimit:3,premiumLimit:2,totalLimit:5},
    ultimate:{price:150,label:'Ultimate Block Party', basicLimit:999,premiumLimit:999,totalLimit:10}
  };

  // UI nodes
  const gamesGrid = document.getElementById('gamesGrid');
  const selectedList = document.getElementById('selectedList');
  const addonsList = document.getElementById('addonsList');
  const summaryPackage = document.getElementById('summaryPackage');
  const summaryGames = document.getElementById('summaryGames');
  const summaryAddons = document.getElementById('summaryAddons');
  const summaryDelivery = document.getElementById('summaryDelivery');
  const summaryTotal = document.getElementById('summaryTotal');
  const selectionNote = document.getElementById('selectionNote');
  const hiddenGames = document.getElementById('hiddenGames');
  const hiddenAddons = document.getElementById('hiddenAddons');
  const hiddenTotal = document.getElementById('hiddenTotal');

  // Selected state
  let selectedGames = []; // array of game ids
  let selectedAddons = [];
  let deliveryMode = 'pickup';

  // Render the large image grid
  function renderGamesGrid(){
    gamesGrid.innerHTML = '';
    GAMES.forEach(g=>{
      const card = document.createElement('div');
      card.className = 'game-card';
      card.setAttribute('data-id', g.id);
      card.innerHTML = `
        <img src="${g.img}" alt="${g.name}" onerror="this.style.filter='grayscale(60%)'; this.src='https://via.placeholder.com/400x240?text=${encodeURIComponent(g.name)}'"/>
        <div class="meta">
          <div style="display:flex;gap:10px;align-items:center">
            <div class="badge ${g.type==='premium'?'premium':'basic'}">${g.badge}</div>
            <div class="title">${g.name}</div>
          </div>
          <div>
            <button class="btn select-btn" onclick="toggleGameSelection('${g.id}')">Select</button>
          </div>
        </div>
      `;
      gamesGrid.appendChild(card);
    });
  }

  // Render addons
  function renderAddons(){
    addonsList.innerHTML = '';
    ADDONS.forEach(a=>{
      const el = document.createElement('label');
      el.className = 'addon';
      el.innerHTML = `<input type="checkbox" value="${a.id}" data-price="${a.price}" onchange="onAddonChange(this)" /> <div style="flex:1"><strong>${a.name}</strong><div class="small muted">$${a.price}</div></div>`;
      addonsList.appendChild(el);
    });
  }

  // Toggle selection from grid or list
  function toggleGameSelection(gameId){
    const idx = selectedGames.indexOf(gameId);
    if(idx>=0) selectedGames.splice(idx,1);
    else selectedGames.push(gameId);
    enforceLimits(); // enforce package limits
    updateSelectionUI();
  }

  function updateSelectionUI(){
    // Update tiles appearance
    document.querySelectorAll('.game-card').forEach(card=>{
      const id = card.getAttribute('data-id');
      const btn = card.querySelector('.select-btn');
      if(selectedGames.includes(id)){
        card.style.border = `2px solid rgba(11,99,216,0.14)`;
        btn.textContent = 'Selected';
        btn.classList.add('secondary');
      } else {
        card.style.border = '';
        btn.textContent = 'Select';
        btn.classList.remove('secondary');
      }
    });

    // Update selectedList
    selectedList.innerHTML = '';
    selectedGames.forEach(id=>{
      const g = GAMES.find(x=>x.id===id);
      if(!g) return;
      const div = document.createElement('div');
      div.style.display='flex'; div.style.justifyContent='space-between'; div.style.padding='6px 0';
      div.innerHTML = `<div>${g.name}</div><div><button class="btn secondary" onclick="toggleGameSelection('${g.id}')">Remove</button></div>`;
      selectedList.appendChild(div);
    });

    updateSummary();
  }

  // Enforce package limits when package selected
  function onPackageChange(){
    enforceLimits();
    updateSummary();
  }

  function enforceLimits(){
    const pkg = document.getElementById('package').value;
    const pkgCfg = PACKAGES[pkg];
    if(!pkgCfg){ selectionNote.textContent='Select a package to see limits.'; return; }
    const basicCount = selectedGames.filter(id=>GAMES.find(g=>g.id===id && g.type==='basic')).length;
    const premiumCount = selectedGames.filter(id=>GAMES.find(g=>g.id===id && g.type==='premium')).length;
    selectionNote.textContent = `Allowed: up to ${pkgCfg.totalLimit} total games. (Basic limit: ${pkgCfg.basicLimit===999?'no limit':pkgCfg.basicLimit}, Premium limit: ${pkgCfg.premiumLimit===999?'no limit':pkgCfg.premiumLimit})`;

    // If over limits, remove newest premium/basic until okay (keeps UX simple)
    let removed=false;
    while(true){
      const total = selectedGames.length;
      if(total<=pkgCfg.totalLimit && basicCount<=pkgCfg.basicLimit && premiumCount<=pkgCfg.premiumLimit) break;
      // remove last selected
      selectedGames.pop();
      removed=true;
    }
    if(removed) updateSelectionUI();
  }

  function onAddonChange(cb){
    const id = cb.value;
    if(cb.checked) selectedAddons.push(id);
    else selectedAddons = selectedAddons.filter(x=>x!==id);
    updateSummary();
  }

  function updateSummary(){
    const pkg = document.getElementById('package').value;
    const pkgCfg = PACKAGES[pkg];
    const addonsSum = selectedAddons.reduce((s,aId)=>{
      const a = ADDONS.find(x=>x.id===aId);
      return s + (a? a.price:0);
    },0);
    const deliveryModeSelect = document.getElementById('delivery');
    deliveryMode = deliveryModeSelect ? deliveryModeSelect.value : 'pickup';
    const deliveryFee = (deliveryMode==='deliver')?30:0;
    const base = pkgCfg ? pkgCfg.price : 0;
    const total = base + addonsSum + deliveryFee;

    summaryPackage.textContent = pkgCfg ? pkgCfg.label : 'â€”';
    summaryGames.textContent = selectedGames.length;
    summaryAddons.textContent = selectedAddons.length;
    summaryDelivery.textContent = deliveryMode==='deliver' ? `$${deliveryFee}` : 'Pickup';
    summaryTotal.textContent = total.toFixed(2);

    hiddenGames.value = selectedGames.join(',');
    hiddenAddons.value = selectedAddons.join(',');
    hiddenTotal.value = total.toFixed(2);
  }

  // Compose email for Option A (pre-filled)
  function composeEmailFromForm(){
    const name = document.getElementById('name').value || '[Name]';
    const phone = document.getElementById('phone').value || '[Phone]';
    const email = document.getElementById('email').value || '[Email]';
    const date = document.getElementById('date').value || '[Date]';
    const pkg = document.getElementById('package').value || '[Package]';
    const pkgLabel = PACKAGES[pkg] ? PACKAGES[pkg].label : pkg;
    const games = selectedGames.map(id=>GAMES.find(g=>g.id===id).name).join(', ') || '(none)';
    const addons = selectedAddons.join(', ') || '(none)';
    const total = document.getElementById('hiddenTotal').value || '0.00';

    const subject = encodeURIComponent(`Booking request â€” ${name} â€” ${date}`);
    const body = encodeURIComponent(
      `Name: ${name}\nPhone: ${phone}\nEmail: ${email}\nDate: ${date}\nPackage: ${pkgLabel}\nGames: ${games}\nAdd-ons: ${addons}\nEstimated total: $${total}\n\nPlease confirm availability and next steps.`
    );
    const mailto = `mailto:playzonepartyrentals@outlook.com?subject=${subject}&body=${body}`;
    window.location.href = mailto;
  }

  // Form submit â€” sends to FORM_ACTION via Fetch (Formspree or your backend)
  function handleSubmit(e){
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const email = document.getElementById('email').value.trim();
    const date = document.getElementById('date').value;
    const pkg = document.getElementById('package').value;
    if(!name || !phone || !email || !date || !pkg){ alert('Please complete required fields.'); return false; }

    // Demo mode if FORM_ACTION placeholder remains
    if(FORM_ACTION.includes('YOUR_FORM_ID')){
      alert('Demo submission â€” form not sent.\nYou used the demo endpoint. Replace FORM_ACTION with your Formspree endpoint to enable live submissions.\n\nA prefilled email will open as fallback.');
      composeEmailFromForm();
      return false;
    }

    // Build FormData
    const form = document.getElementById('bookingForm');
    const fd = new FormData(form);
    fd.append('games', hiddenGames.value);
    fd.append('addons', hiddenAddons.value);
    fd.append('estimated_total', hiddenTotal.value);

    fetch(FORM_ACTION, { method:'POST', body:fd, headers:{ 'Accept':'application/json' } })
      .then(res => res.json())
      .then(json => {
        alert('Thanks â€” your booking request was sent. We will contact you shortly.');
        resetForm();
      })
      .catch(err=>{
        console.error(err);
        alert('There was a problem sending the form. Opening a prefilled email as fallback.');
        composeEmailFromForm();
      });

    return false;
  }

  function resetForm(){
    document.getElementById('bookingForm').reset();
    selectedGames = [];
    selectedAddons = [];
    renderGamesGrid();
    renderAddons();
    updateSelectionUI();
    updateSummary();
  }

  // ========== Calendar (client-side) ==========
  // Very lightweight: displays month days and allows selecting date.
  // For production, connect Calendly or Google Calendar for real availability.
  const calendarContainer = document.getElementById('calendarContainer');
  const bookedDates = []; // admin can add ISO dates here to mark booked day e.g. ['2025-12-24']
  let shownMonth = new Date();

  function renderCalendar(date){
    calendarContainer.innerHTML = '';
    const year = date.getFullYear(), month = date.getMonth();
    const first = new Date(year, month, 1);
    const last = new Date(year, month+1, 0);
    const startDay = first.getDay(); // 0..6
    const grid = document.createElement('div');
    grid.className = 'calendar-grid';

    // header
    const header = document.createElement('div');
    header.style.display='flex'; header.style.justifyContent='space-between'; header.style.alignItems='center'; header.style.marginBottom='6px';
    const title = document.createElement('div'); title.innerHTML = `<strong>${first.toLocaleString(undefined,{month:'long'})} ${year}</strong>`;
    const nav = document.createElement('div');
    nav.innerHTML = `<button onclick="changeMonth(-1)" class="btn secondary" style="padding:6px 8px">â—€</button> <button onclick="changeMonth(1)" class="btn secondary" style="padding:6px 8px">â–¶</button>`;
    header.appendChild(title); header.appendChild(nav);
    calendarContainer.appendChild(header);

    // weekday labels
    const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
    days.forEach(d=>{ const el=document.createElement('div'); el.className='day'; el.style.fontWeight='700'; el.style.background='transparent'; el.textContent=d; grid.appendChild(el); });

    // blanks
    for(let i=0;i<startDay;i++){ const el=document.createElement('div'); el.className='day'; grid.appendChild(el); }

    // days
    for(let d=1; d<=last.getDate(); d++){
      const el = document.createElement('div');
      el.className='day';
      const cur = new Date(year,month,d);
      const iso = cur.toISOString().slice(0,10);
      el.textContent = d;
      if(iso === (new Date()).toISOString().slice(0,10)) el.classList.add('today');
      if(bookedDates.includes(iso)) el.classList.add('booked');
      el.onclick = ()=>{ if(bookedDates.includes(iso)) { alert('This date is marked as booked. Consider choosing another date.'); return; } selectDate(iso); };
      grid.appendChild(el);
    }
    calendarContainer.appendChild(grid);
  }

  function changeMonth(n){ shownMonth = new Date(shownMonth.getFullYear(), shownMonth.getMonth()+n, 1); renderCalendar(shownMonth); }
  function selectDate(iso){
    document.getElementById('date').value = iso;
    // visually mark selected day
    document.querySelectorAll('.calendar .day').forEach(x=>x.classList.remove('selected'));
    // find matching node and add class
    document.querySelectorAll('.calendar .day').forEach(x=>{ if(x.textContent == new Date(iso).getDate()) x.classList.add('selected'); });
  }

  // Initial render
  renderGamesGrid();
  renderAddons();
  renderCalendar(new Date());
  updateSummary();

  // Expose for HTML onclicks
  window.toggleGameSelection = toggleGameSelection;
  window.renderGamesGrid = renderGamesGrid;
  window.renderAddons = renderAddons;
  window.onPackageChange = onPackageChange;
  window.composeEmailFromForm = composeEmailFromForm;
  window.handleSubmit = handleSubmit;
  window.resetForm = resetForm;
</script>
</body>
</html>
